"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var path=require("path"),mongoose=require("mongoose"),mongoosePaginate=require("mongoose-paginate-v2"),autoPopulate=require("mongoose-autopopulate"),Schemas=require("../schema/mongo.Schemas"),InternalSchemas=require("../models"),_process$env=process.env,DB_HOST=_process$env.DB_HOST,DB_PORT=_process$env.DB_PORT,DB_DATABASE=_process$env.DB_DATABASE,connect=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:function(){};mongoose.connect("mongodb://".concat(DB_HOST,":").concat(DB_PORT,"/").concat(DB_DATABASE),{useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1,useCreateIndex:!0},function(b){if(b&&debug.danger(b.message),env.APP_DEBUG&&debug.success("Database MongoDB successfully connected in ".concat(env.APP_ENV," mode."),!1),"function"==typeof a)return a(b)})},asyncConnect=/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(){return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,mongoose.connect("mongodb://".concat(DB_HOST,":").concat(DB_PORT,"/").concat(DB_DATABASE),{useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1,useCreateIndex:!0});case 3:a.next=8;break;case 5:throw a.prev=5,a.t0=a["catch"](0),a.t0;case 8:case"end":return a.stop();}},a,null,[[0,5]])}));return function(){return a.apply(this,arguments)}}(),disconnect=/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(){return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,mongoose.connection.close();case 3:return a.next=5,mongoose.disconnect();case 5:a.next=10;break;case 7:throw a.prev=7,a.t0=a["catch"](0),a.t0;case 10:case"end":return a.stop();}},a,null,[[0,7]])}));return function(){return a.apply(this,arguments)}}(),models={},internalModels={};// Internal models
// Override internal models
Schemas.forEach(function(a){var b=a.name,c=a.schema;c.plugin(autoPopulate),c.plugin(mongoosePaginate),models[b]=mongoose.model(b,c)}),InternalSchemas.forEach(function(a){var b=a.name,c=a.model;internalModels[b]=c}),module.exports={connect:connect,asyncConnect:asyncConnect,disconnect:disconnect,models:_objectSpread(_objectSpread({},internalModels),models)};